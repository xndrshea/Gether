"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.parseAndEvalExpression = void 0;
const constEval_1 = require("./constEval");
const context_1 = require("./context");
const errors_1 = require("./errors");
const grammar_1 = require("./grammar/grammar");
function parseAndEvalExpression(sourceCode) {
    try {
        const ast = (0, grammar_1.parseExpression)(sourceCode);
        const constEvalResult = (0, constEval_1.evalConstantExpression)(ast, new context_1.CompilerContext());
        return { kind: "ok", value: constEvalResult };
    }
    catch (error) {
        if (error instanceof errors_1.TactParseError ||
            error instanceof errors_1.TactConstEvalError)
            return { kind: "error", message: error.message };
        throw error;
    }
}
exports.parseAndEvalExpression = parseAndEvalExpression;
